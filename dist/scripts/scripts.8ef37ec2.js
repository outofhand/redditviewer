angular.module("pageslide-directive",[]).directive("pageslide",[function(){return{restrict:"EAC",transclude:!1,scope:{psOpen:"=?",psAutoClose:"=?",psSide:"@",psSpeed:"@",psClass:"@",psSize:"@",psSqueeze:"@",psCloak:"@",psPush:"@"},link:function(a,b,c){function d(b,c){if(b&&0!==b.style.width&&0!==b.style.width)switch(c.cloak&&g.css("display","none"),c.side){case"right":b.style.width="0px",c.squeeze&&(i.style.right="0px"),c.push&&(i.style.right="0px",i.style.left="0px");break;case"left":b.style.width="0px",c.squeeze&&(i.style.left="0px"),c.push&&(i.style.left="0px",i.style.right="0px");break;case"top":b.style.height="0px",c.squeeze&&(i.style.top="0px"),c.push&&(i.style.top="0px",i.style.bottom="0px");break;case"bottom":b.style.height="0px",c.squeeze&&(i.style.bottom="0px"),c.push&&(i.style.bottom="0px",i.style.top="0px")}a.psOpen=!1}function e(a,b){if(0!==a.style.width&&0!==a.style.width){switch(b.side){case"right":a.style.width=b.size,b.squeeze&&(i.style.right=b.size),b.push&&(i.style.right=b.size,i.style.left="-"+b.size);break;case"left":a.style.width=b.size,b.squeeze&&(i.style.left=b.size),b.push&&(i.style.left=b.size,i.style.right="-"+b.size);break;case"top":a.style.height=b.size,b.squeeze&&(i.style.top=b.size),b.push&&(i.style.top=b.size,i.style.bottom="-"+b.size);break;case"bottom":a.style.height=b.size,b.squeeze&&(i.style.bottom=b.size),b.push&&(i.style.bottom=b.size,i.style.top="-"+b.size)}setTimeout(function(){b.cloak&&g.css("display","block")},1e3*b.speed)}}var f={};f.side=a.psSide||"right",f.speed=a.psSpeed||"0.5",f.size=a.psSize||"300px",f.zindex=1e3,f.className=a.psClass||"ng-pageslide",f.cloak=a.psCloak&&"false"==a.psCloak.toLowerCase()?!1:!0,f.squeeze=Boolean(a.psSqueeze)||!1,f.push=Boolean(a.psPush)||!1,b.addClass(f.className);var g=null,h=null,i=document.body;if(h=b[0],"div"!==h.tagName.toLowerCase()&&"pageslide"!==h.tagName.toLowerCase())throw new Error("Pageslide can only be applied to <div> or <pageslide> elements");if(0===h.children.length)throw new Error("You have to content inside the <pageslide>");switch(g=angular.element(h.children),i.appendChild(h),h.style.zIndex=f.zindex,h.style.position="fixed",h.style.width=0,h.style.height=0,h.style.overflow="auto",h.style.transitionDuration=f.speed+"s",h.style.webkitTransitionDuration=f.speed+"s",h.style.transitionProperty="width, height",f.squeeze&&(i.style.position="absolute",i.style.transitionDuration=f.speed+"s",i.style.webkitTransitionDuration=f.speed+"s",i.style.transitionProperty="top, bottom, left, right"),f.side){case"right":h.style.height=c.psCustomHeight||"100%",h.style.top=c.psCustomTop||"0px",h.style.bottom=c.psCustomBottom||"0px",h.style.right=c.psCustomRight||"0px";break;case"left":h.style.height=c.psCustomHeight||"100%",h.style.top=c.psCustomTop||"0px",h.style.bottom=c.psCustomBottom||"0px",h.style.left=c.psCustomLeft||"0px";break;case"top":h.style.width=c.psCustomWidth||"100%",h.style.left=c.psCustomLeft||"0px",h.style.top=c.psCustomTop||"0px",h.style.right=c.psCustomRight||"0px";break;case"bottom":h.style.width=c.psCustomWidth||"100%",h.style.bottom=c.psCustomBottom||"0px",h.style.left=c.psCustomLeft||"0px",h.style.right=c.psCustomRight||"0px"}a.$watch("psOpen",function(a){a?e(h,f):d(h,f)}),a.$on("$destroy",function(){document.body.removeChild(h)}),a.psAutoClose&&(a.$on("$locationChangeStart",function(){d(h,f)}),a.$on("$stateChangeStart",function(){d(h,f)}))}}}]),function(){"use strict";function a(a){var b=a.match(/^\s*([\$\w]+)\s+in\s+([\S\s]*)\s+of\s+([\S\s]*)$/);if(!b)throw new Error("Expected sfTreepeat in form of '_item_ in _collection_ of _root_' but got '"+a+"'.");return{value:b[1],collection:b[2],root:b[3]}}var b=angular.module("sf.treeRepeat",[]);b.directive("sfTreepeat",["$log",function(b){return{restrict:"A",scope:!0,controller:["$scope","$attrs",function(c,d){var e=this.ident=a(d.sfTreepeat);b.info("Parsed '%s' as %s",d.sfTreepeat,JSON.stringify(this.ident)),c.$watch(this.ident.root,function(a){c[e.value]=a})}],compile:function(a){var b=a.html();return{pre:function(a,c,d,e){e.template=b}}}}}]),b.directive("sfTreecurse",["$compile",function(a){return{require:"^sfTreepeat",link:function(b,c,d,e){var f=["<",c.context.tagName,' ng-repeat="',e.ident.value," in ",e.ident.value,".",e.ident.collection,'">',e.template,"</",c.context.tagName,">"],g=angular.element(f.join(""));c.replaceWith(g),a(g)(b)}}}])}();var mod;mod=angular.module("infinite-scroll",[]),mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g,h,i,j;return b=angular.element(b),i=0,null!=f.infiniteScrollDistance&&d.$watch(f.infiniteScrollDistance,function(a){return i=parseInt(a,10)}),j=!0,g=!1,null!=f.infiniteScrollDisabled&&d.$watch(f.infiniteScrollDisabled,function(a){return j=!a,j&&g?(g=!1,h()):void 0}),h=function(){var c,h,k,l;return l=b.height()+b.scrollTop(),c=e.offset().top+e.height(),h=c-l,k=h<=b.height()*i,k&&j?a.$$phase?d.$eval(f.infiniteScroll):d.$apply(f.infiniteScroll):k?g=!0:void 0},b.on("scroll",h),d.$on("$destroy",function(){return b.off("scroll",h)}),c(function(){return f.infiniteScrollImmediateCheck?d.$eval(f.infiniteScrollImmediateCheck)?h():void 0:h()},0)}}}]),angular.module("redditApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","pageslide-directive","sf.treeRepeat","infinite-scroll"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("redditApp").controller("MainCtrl",["$scope","$http","$sce","JobManager","Reddit",function(a,b,c,d,e){a.reddit=new e,a.definitions={},a.posts=[],a.subreddit="aww",a.nextPage="",a.renderHTML=function(a){var b=angular.element("<textarea />").html(a).text();return c.trustAsHtml(b)},a.getNextPage=function(b){a.reddit=new e,a.reddit.nextPage(b)},a.reddits=[{label:"aww"},{label:"funny"},{label:"pics"},{label:"Creatures_of_earth"},{label:"GrilledCheese"},{label:"nonononoYES"}],a.setSelected=function(b){a.subreddit=b,a.checked=!a.checked},a.checked=!1,a.toggle=function(){a.checked=!a.checked},a.toggleComments=function(){a.checked2=!a.checked2},a.checked2=!1,a.toggle2=function(b){a.checked2=!a.checked2,a.checked2&&(console.log("postId = "+b+" subreddit = "+a.subreddit),a.getComments2(b))},a.getNext=function(){a.definitions={},a.posts=[],a.spinner=!0,console.log("next page = "+a.nextPage),d.getNext(a.subreddit,a.nextPage).then(function(b){if(a.spinner=!1,0===b.length)a.error=!0,a.message="No results found for subreddit "+a.subreddit,console.log("error");else for(var c=b.data.children,d=0;d<c.length;d++){if(!c[d].data.is_self){var e=/imgur\.com/;if(e.test(c[d].data.url)){var f=/.gifv$/;if(!f.test(c[d].data.url)){c[d].data.url=c[d].data.url+".png";var g="";g=null!=c[d].data.media?c[d].data.media.oembed.thumbnail_url:c[d].data.url;var h={id:c[d].data.id,url:c[d].data.url,title:c[d].data.title,permalink:"http://reddit.com"+c[d].data.permalink,subreddit:c[d].data.subreddit,ups:c[d].data.ups,author:c[d].data.author,domain:c[d].data.domain,thumbnail:g,commentCount:c[d].data.num_comments};a.posts.push(h)}}}a.nextPage=b.data.after}})},a.findWord=function(b){a.definitions={},a.posts=[],a.spinner=!0,d.getAll(b).then(function(c){if(a.spinner=!1,0===c.length)a.error=!0,a.message="No results found for subreddit "+b,console.log("error");else for(var d=c.data.children,e=0;e<d.length;e++){if(!d[e].data.is_self){var f=/imgur\.com/;if(f.test(d[e].data.url)){var g=/.gifv$/;if(!g.test(d[e].data.url)){d[e].data.url=d[e].data.url+".png";var h="";h=null!=d[e].data.media?d[e].data.media.oembed.thumbnail_url:d[e].data.url;var i={id:d[e].data.id,url:d[e].data.url,title:d[e].data.title,permalink:"http://reddit.com"+d[e].data.permalink,subreddit:d[e].data.subreddit,ups:d[e].data.ups,author:d[e].data.author,domain:d[e].data.domain,thumbnail:h,commentCount:d[e].data.num_comments};a.posts.push(i)}}}a.nextPage=c.data.after}})},a.getComments=function(b){a.comments=[],d.getComments(a.subreddit,b).then(function(c){if(console.log("subreddit = "+a.subreddit+" postId = "+b),console.log(c),0===c.length)a.error=!0,a.message="No comments found.",console.log("error - "+a.message);else{console.log(c[1].data.children);var d=c[1].data.children;console.log("items = "+d);for(var e=0;e<d.length;e++){var f=d[e].data.body,g=d[e].data.author,h={author:g,comment:f};a.comments.push(h)}}console.log("comments = "+a.comments)})},a.getComments2=function(c){b.get("http://www.reddit.com/r/"+a.subreddit+"/comments/"+c+".json").then(function(b){a.treeData=b.data,a.toggleComments()})}}]).service("JobManager",["$q","$http",function(a,b){return{getAll:function(c){var d=a.defer(),e="http://api.reddit.com/r/"+c+"/.json?limit=5&jsonp=JSON_CALLBACK";return b.jsonp(e).success(function(a){d.resolve(a)}).error(function(a,b,c,e){d.resolve("")}),d.promise},getNext:function(c,d){var e=a.defer(),f="http://api.reddit.com/r/"+c+"/.json?&after="+d+"&jsonp=JSON_CALLBACK";return b.jsonp(f).success(function(a){e.resolve(a)}).error(function(a,b,c,d){e.resolve("")}),e.promise},getComments:function(c,d){var e=a.defer(),f="http://api.reddit.com/r/"+c+"/comments/"+d+".json?jsonp=JSON_CALLBACK";return b.jsonp(f).success(function(a){console.log("success"),e.resolve(a)}).error(function(a,b,c,d){console.log("error "+b),e.resolve("")}),e.promise}}}]).factory("Reddit",["$http",function(a){var b=function(){this.items=[],this.busy=!1,this.after=""};return b.prototype.nextPage=function(b){if(!(b.length<2||this.busy)){this.busy=!0;var c="http://api.reddit.com/r/"+b+"?after="+this.after+"&jsonp=JSON_CALLBACK";a.jsonp(c).success(function(a){if(0===a.length)$scope.error=!0,$scope.message="No results found for subreddit "+b,console.log("error");else for(var c=a.data.children,d=0;d<c.length;d++)if(!c[d].data.is_self){var e=/imgur\.com/;if(e.test(c[d].data.url)){var f=/.gifv$/;if(!f.test(c[d].data.url)){c[d].data.url=c[d].data.url+".png";var g="";g=null!=c[d].data.media?c[d].data.media.oembed.thumbnail_url:c[d].data.url;var h={id:c[d].data.id,url:c[d].data.url,title:c[d].data.title,permalink:"http://reddit.com"+c[d].data.permalink,subreddit:c[d].data.subreddit,ups:c[d].data.ups,author:c[d].data.author,domain:c[d].data.domain,thumbnail:g,commentCount:c[d].data.num_comments};this.items.push(h)}}}this.after="t3_"+this.items[this.items.length-1].id,this.busy=!1}.bind(this))}},b}]),angular.module("redditApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);